(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{376:function(s,a,t){"use strict";t.r(a);var e=t(42),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker-使用文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-使用文档"}},[s._v("#")]),s._v(" Docker 使用文档")]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("p",[s._v("以下以 "),t("code",[s._v("CentOS7+")]),s._v(" 为例，其余请参考"),t("a",{attrs:{href:"https://docs.docker.com/engine/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("：")]),s._v(" "),t("h3",{attrs:{id:"先卸载旧版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#先卸载旧版本"}},[s._v("#")]),s._v(" 先卸载旧版本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"安装新版本（使用仓库）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装新版本（使用仓库）"}},[s._v("#")]),s._v(" 安装新版本（使用仓库）")]),s._v(" "),t("h4",{attrs:{id:"安装需要的安装包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装需要的安装包"}},[s._v("#")]),s._v(" 安装需要的安装包")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"设置安装仓库地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置安装仓库地址"}},[s._v("#")]),s._v(" 设置安装仓库地址")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://download.docker.com/linux/centos/docker-ce.repo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 可以将地址改为国内镜像（百度搜 "docker镜像地址" 即可）')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阿里云镜像地址：http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"更新-yum"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新-yum"}},[s._v("#")]),s._v(" 更新 yum")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum makecache fast\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"安装-docker-引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker-引擎"}},[s._v("#")]),s._v(" 安装 docker 引擎")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"测试启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试启动"}},[s._v("#")]),s._v(" 测试启动")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl start docker\n\ndocker verion\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("显示如下内容，即安装成功。")]),s._v(" "),t("img",{attrs:{src:s.$withBase("/assets/pic/docker-version.png"),alt:"docker-version"}}),s._v(" "),t("h4",{attrs:{id:"运行测试程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行测试程序"}},[s._v("#")]),s._v(" 运行测试程序")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker run hello-world\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("该命令会尝试寻找名称为 "),t("code",[s._v("hello-world")]),s._v(" 的仓库，如果没有找到，则会去远程仓库寻找并尝试拉取。")]),s._v(" "),t("p",[s._v("如果显示：")]),s._v(" "),t("img",{attrs:{src:s.$withBase("/assets/pic/docker-run-hello-world.png"),alt:"docker-run-hello-world"}}),s._v(" "),t("p",[s._v("则说明已经运行成功。")]),s._v(" "),t("h3",{attrs:{id:"卸载-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#卸载-docker"}},[s._v("#")]),s._v(" 卸载 docker")]),s._v(" "),t("h4",{attrs:{id:"卸载-docker-引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#卸载-docker-引擎"}},[s._v("#")]),s._v(" 卸载 docker 引擎")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"删除-docker-资源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除-docker-资源"}},[s._v("#")]),s._v(" 删除 docker 资源")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker 默认路径")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"镜像常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像常用命令"}},[s._v("#")]),s._v(" 镜像常用命令")]),s._v(" "),t("h3",{attrs:{id:"查看信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看信息"}},[s._v("#")]),s._v(" 查看信息")]),s._v(" "),t("h4",{attrs:{id:"查看-docker-版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看-docker-版本"}},[s._v("#")]),s._v(" 查看 docker 版本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker version\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"查看-docker-信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看-docker-信息"}},[s._v("#")]),s._v(" 查看 docker 信息")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker info\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("更多可以查看"),t("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"查看镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看镜像"}},[s._v("#")]),s._v(" 查看镜像")]),s._v(" "),t("h4",{attrs:{id:"查看主机上的所有镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看主机上的所有镜像"}},[s._v("#")]),s._v(" 查看主机上的所有镜像")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker images "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-q"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-a")]),s._v(" 显示全部")]),s._v(" "),t("li",[t("code",[s._v("-q")]),s._v(" 只显示 ID")])]),s._v(" "),t("h4",{attrs:{id:"查找远程镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查找远程镜像"}},[s._v("#")]),s._v(" 查找远程镜像")]),s._v(" "),t("p",[s._v("可以通过名称直接搜索远程仓库中的镜像：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker search "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("condition"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-f=<condition>")]),s._v(" 搜索条件，如：")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("-f"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STARS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stars 数量大于500")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"拉取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker pull "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("tag 如果不写，默认为 "),t("code",[s._v("lastest")]),s._v("，一般需要指定版本时填写，"),t("code",[s._v("tag")]),s._v(" 必须在镜像库中存在。")])]),s._v(" "),t("h3",{attrs:{id:"删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除镜像"}},[s._v("#")]),s._v(" 删除镜像")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker rmi -f "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("image 可以写镜像 ID 或者镜像名，通常写 ID。支持删除多个镜像")])]),s._v(" "),t("h4",{attrs:{id:"条件删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#条件删除"}},[s._v("#")]),s._v(" 条件删除")]),s._v(" "),t("p",[s._v("可以结合 linux 系统命令进行条件删除。如删除全部：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker rmi -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker images -aq"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"给镜像添加标签"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#给镜像添加标签"}},[s._v("#")]),s._v(" 给镜像添加标签")]),s._v(" "),t("p",[s._v("有时需要单独给已经存在的镜像添加标签，可以通过：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker tag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("镜像ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"官方镜像的文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官方镜像的文档"}},[s._v("#")]),s._v(" 官方镜像的文档")]),s._v(" "),t("p",[s._v("所有远程镜像一般都有详细的"),t("a",{attrs:{href:"https://hub.docker.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),t("OutboundLink")],1),s._v("，直接搜索对应镜像名称后方可自行查看。")]),s._v(" "),t("h2",{attrs:{id:"容器常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器常用命令"}},[s._v("#")]),s._v(" 容器常用命令")]),s._v(" "),t("p",[s._v("容器，就是镜像在运行时的环境。同一个镜像可以多次启动，同时会生成多个容器，每一个容器虽然环境一样，但是它们的 ID 却不一样，说明它们不是同一个容器。")]),s._v(" "),t("h3",{attrs:{id:"查看启动的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看启动的容器"}},[s._v("#")]),s._v(" 查看启动的容器")]),s._v(" "),t("p",[s._v("查看当前正在运行的容器")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数们"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-a")]),s._v(" 查看历史启动记录")]),s._v(" "),t("li",[t("code",[s._v("-n=<number>")]),s._v(" 查看最近 n 条创建的容器")]),s._v(" "),t("li",[t("code",[s._v("-q")]),s._v(" 只显示容器 ID")])]),s._v(" "),t("h3",{attrs:{id:"删除容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-f")]),s._v(" 加上该参数，会强制删除包括正在运行的容器。")])]),s._v(" "),t("p",[s._v("还可以与删除镜像类似，使用参数方式：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除全部容器")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"运行容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行容器"}},[s._v("#")]),s._v(" 运行容器")]),s._v(" "),t("p",[s._v("通过 "),t("code",[s._v("run")]),s._v(" 命令可以直接启动容器，同时如果本地找不到，则会去远程仓库搜索并拉取（参照"),t("a",{attrs:{href:"#%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95%E7%A8%8B%E5%BA%8F"}},[s._v("测试运行")]),s._v("）。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数们"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("--name=<name>")]),s._v(" 给容器起个名字")]),s._v(" "),t("li",[t("code",[s._v("-d")]),s._v(" 以后台方式运行")]),s._v(" "),t("li",[t("code",[s._v("-i")]),s._v(" 使用交互方式运行")]),s._v(" "),t("li",[t("code",[s._v("-t")]),s._v(" 分配一个虚拟终端（与 "),t("code",[s._v("-i")]),s._v(" 一起使用，通常为 "),t("code",[s._v("-it")]),s._v("）")]),s._v(" "),t("li",[t("code",[s._v("-p")]),s._v(" 指定容器端口。还可以与主机端口进行映射，格式："),t("code",[s._v("主机端口:容器端口")]),s._v("，如："),t("code",[s._v("8080:8080")])]),s._v(" "),t("li",[t("code",[s._v("-P")]),s._v(" 指定一个随机端口")]),s._v(" "),t("li",[t("code",[s._v("-v [<容器卷名>:][/<本地目录>:]<容器目录>[:<权限>]")]),s._v(" 挂载目录。\n"),t("ul",[t("li",[s._v("以 "),t("code",[s._v("/")]),s._v(" 开头的为目录，否则是置顶的卷名。卷名一般在 "),t("code",[s._v("/var/lib/docker/volumes/<容器卷名>/_data")]),s._v(" 中。")]),s._v(" "),t("li",[s._v("权限通常是 "),t("code",[s._v("ro")]),s._v(" 或 "),t("code",[s._v("rw")]),s._v("，意为 "),t("code",[s._v("readonly")]),s._v(" 或 "),t("code",[s._v("readwrite")])])])])]),s._v(" "),t("h3",{attrs:{id:"进入容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[s._v("#")]),s._v(" 进入容器")]),s._v(" "),t("p",[s._v("通常启动容器都是以 "),t("code",[s._v("-d")]),s._v(" 的后台方式，有时需要进入容器内部，此时需要命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面的命令会创建一个新的交互环境。")]),s._v(" "),t("p",[s._v("还可以通过下面命令进入容器内部，只不过会进入到容器内正在执行的环境：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker attach "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"退出容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#退出容器"}},[s._v("#")]),s._v(" 退出容器")]),s._v(" "),t("p",[s._v("在容器交互模式下，可以选择仅退出容器或者退出并关闭容器。")]),s._v(" "),t("h4",{attrs:{id:"仅退出容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#仅退出容器"}},[s._v("#")]),s._v(" 仅退出容器")]),s._v(" "),t("p",[s._v("该退出方式不影响容器的运行，使用快捷键直接退出：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Ctrl + P + Q\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"退出并关闭容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#退出并关闭容器"}},[s._v("#")]),s._v(" 退出并关闭容器")]),s._v(" "),t("p",[s._v("该退出方式会直接关闭容器，使用交互命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"启动与停止容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动与停止容器"}},[s._v("#")]),s._v(" 启动与停止容器")]),s._v(" "),t("p",[s._v("容器可以停止，也可以继续启动。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker start "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器")]),s._v("\ndocker restart "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启容器")]),s._v("\ndocker pause "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂停容器")]),s._v("\ndocker unpause "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消暂停容器")]),s._v("\ndocker stop "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止容器")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制停止容器")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"查看容器日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器日志"}},[s._v("#")]),s._v(" 查看容器日志")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker logs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数们"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-f")]),s._v(" 跟踪日志输出")]),s._v(" "),t("li",[t("code",[s._v("-t")]),s._v(" 时间戳")]),s._v(" "),t("li",[t("code",[s._v("--tail <数量>")]),s._v(" 显示的条数，默认 "),t("code",[s._v("all")]),s._v("，显示全部。")]),s._v(" "),t("li",[t("code",[s._v("--details")]),s._v(" 显示详细信息")]),s._v(" "),t("li",[t("code",[s._v("since <time>")]),s._v(" 日志起始时间。格式 UTC（2020-01-01T00:00:01），或者相对时间，如：30m，30 minutes")]),s._v(" "),t("li",[t("code",[s._v("until <time>")]),s._v(" 日志截止时间。格式同上")])]),s._v(" "),t("h3",{attrs:{id:"查看容器内进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器内进程"}},[s._v("#")]),s._v(" 查看容器内进程")]),s._v(" "),t("p",[s._v("与 linux 类似：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"查看容器详细信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器详细信息"}},[s._v("#")]),s._v(" 查看容器详细信息")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker inspect "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"文件操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件操作"}},[s._v("#")]),s._v(" 文件操作")]),s._v(" "),t("h4",{attrs:{id:"拷贝容器内部文件到主机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拷贝容器内部文件到主机"}},[s._v("#")]),s._v(" 拷贝容器内部文件到主机")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器内路径"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("主机路径"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),t("p",[s._v("DokcerFile 是构建一个自定义 Docker 镜像的文件，如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# syntax=docker/dockerfile:1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" ubuntu:18.04")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . /app")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" make /app")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" python /app/app.py")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("Docker 镜像由只读层组成，每层代表一个 Dockerfile 指令。这些层是堆叠的，每一层都是前一层变化的增量。")]),s._v(" "),t("h3",{attrs:{id:"dockerfile-常用指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-常用指令"}},[s._v("#")]),s._v(" DockerFile 常用指令")]),s._v(" "),t("p",[s._v("指令速览：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("        # 基础镜像名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v("       # 镜像维护者信息")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v("         # 构建镜像时需要执行的命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v("  # 指定容器启动时运行的命令，可执行多个命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v("         # 指定容器启动时运行的命令，只有最后一个命令生效")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v("      # 保留端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v("         # 设置环境变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v("         # 需要添加内容的压缩包，会自动解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v("        # 拷贝文件到镜像中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v("      # 挂载主机目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v("     # 设置当前工作目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ONBUILD")]),s._v("     # 子镜像构建时触发")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h4",{attrs:{id:"from"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[s._v("#")]),s._v(" FROM")]),s._v(" "),t("p",[s._v("尽可能使用官方镜像作为镜像的基础。如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" ubuntu:18.04")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"label"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[s._v("#")]),s._v(" LABEL")]),s._v(" "),t("p",[s._v("像镜像中添加标签，包括维护者、组织、记录许可信息等")]),s._v(" "),t("p",[s._v("一个镜像可以有多个标签，每个标签都应该是一行以 "),t("code",[s._v("LABEL")]),s._v(" 开头并跟一个键值对，如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" com.example.version="),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.1-beta"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" vendor1="),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ACME Incorporated"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" vendor2=ZENITH\\ Incorporated")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" com.example.release-date="),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2015-02-12"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" com.example.version.is-production="),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("空格必须"),t("strong",[s._v("转义")]),s._v("或者"),t("strong",[s._v("使用"),t("code",[s._v('"')]),s._v("引起来")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"run"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" RUN")]),s._v(" "),t("p",[s._v("构建镜像时需要执行的命令。")]),s._v(" "),t("p",[s._v("多条"),t("code",[s._v("RUN")]),s._v(" 语句单独可能会导致不确定问题，所以可以通过 "),t("code",[s._v("&&")]),s._v(" 将多条命令连接，同时命令可以在用反斜杠("),t("code",[s._v("\\")]),s._v(")分割的多行上拆分，使语句更具可读性、维护性。如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt-get update && apt-get install -y "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    package-bar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    package-baz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    package-foo=1.3.*")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"entrypoint-与-cmd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint-与-cmd"}},[s._v("#")]),s._v(" ENTRYPOINT 与 CMD")]),s._v(" "),t("p",[s._v("两个指令都是用于镜像内要执行的命令。")]),s._v(" "),t("p",[t("code",[s._v("ENTRYPOINT")]),s._v(" 可以设置镜像的主命令，允许镜像像该命令一样运行。如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"executable"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param1"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param2"')]),s._v(", ...]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 举例：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("code",[s._v("CMD")]),s._v(" 指令应用于运行镜像中包含的软件以及任何参数。"),t("code",[s._v("CMD")]),s._v(" 通常应以如下方式出现：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Executable"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param1"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param2"')]),s._v(", ...]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("但是当只有参数时，会作为 "),t("code",[s._v("ENTRYPOINT")]),s._v(" 的参数传入。如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-l"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("最后会被编译为 "),t("code",[s._v("ls -al")]),s._v("。")]),s._v(" "),t("p",[t("strong",[s._v("如果")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("CMD")]),s._v(" 指令，当启动镜像并传入一些附加指令时，会替换掉原有 "),t("code",[s._v("CMD")]),s._v(" 指令。")]),s._v(" "),t("li",[s._v("使用 "),t("code",[s._v("ENTRYPOINT")]),s._v(" 指令，则该指令为主指令，并且将 "),t("code",[s._v("CMD")]),s._v(" 指令内容与启动镜像时传入的附加指令一同作为附属指令一起执行。")])]),s._v(" "),t("h4",{attrs:{id:"expose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[s._v("#")]),s._v(" EXPOSE")]),s._v(" "),t("p",[t("code",[s._v("EXPOSE")]),s._v(" 指令告知容器侦听连接的端口。")]),s._v(" "),t("h4",{attrs:{id:"env"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[s._v("#")]),s._v(" ENV")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("ENV")]),s._v(" 与 "),t("code",[s._v("PATH")]),s._v(" 容器安装软件的环境变量，还可用于提供特定容器化服务所需的环境变量，同时还可以设置常用的版本号。如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" PG_MAJOR=9.3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" PG_VERSION=9.3.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" curl -SL https://example.com/postgres-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PG_VERSION")]),s._v(".tar.xz | tar -xJC /usr/src/postgres && …")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" PATH=/usr/local/postgres-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PG_MAJOR")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PATH")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"add-与-copy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-与-copy"}},[s._v("#")]),s._v(" ADD 与 COPY")]),s._v(" "),t("p",[s._v("两者功能类似，都可以将宿主文件赋值到容器中。但是官方更推荐使用 "),t("code",[s._v("COPY")]),s._v("。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("虽然 "),t("code",[s._v("ADD")]),s._v(" 具备从远程拉取文件的能力，例如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" https://example.com/big.tar.xz /usr/src/things/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("但是强烈不鼓励这样做，应该通过 "),t("code",[s._v("curl")]),s._v(" 或者 "),t("code",[s._v("wget")]),s._v(" 等命令进行获取。这样可以最大化控制镜像的大小。")])]),s._v(" "),t("h4",{attrs:{id:"volume"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[s._v("#")]),s._v(" VOLUME")]),s._v(" "),t("p",[t("code",[s._v("VOLUME")]),s._v(" 指令用于挂载文件/文件夹到容器中。")]),s._v(" "),t("h4",{attrs:{id:"workdir"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#workdir"}},[s._v("#")]),s._v(" WORKDIR")]),s._v(" "),t("p",[t("code",[s._v("WORKDIR")]),s._v(" 指令用于设置当前工作目录。为了清晰可靠，应该始终保持 "),t("code",[s._v("WORKDIR")]),s._v(" 为绝对路径。")]),s._v(" "),t("h4",{attrs:{id:"onbuild"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#onbuild"}},[s._v("#")]),s._v(" ONBUILD")]),s._v(" "),t("p",[s._v("当一个 "),t("code",[s._v("DockerFile")]),s._v(" 构建完成后，"),t("code",[s._v("ONBUILD")]),s._v(" 指令将被触发执行。该指令会在任何当前镜像所衍生出来的子镜像中执行。")]),s._v(" "),t("h3",{attrs:{id:"dockerfile-官方参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-官方参考"}},[s._v("#")]),s._v(" DockerFile 官方参考")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方参考"),t("OutboundLink")],1),s._v(" 把 DockerFile 每个指令讲解的很详细。")]),s._v(" "),t("h3",{attrs:{id:"构建镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像"}},[s._v("#")]),s._v(" 构建镜像")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker build "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("filename"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -t "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("target_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("filename")]),s._v(" 如果文件名为 Dockerfile 就不用写了，指令会自动在当前目录下查找。")]),s._v(" "),t("li",[t("code",[s._v("tag")]),s._v(" 如果给了 tag，则会生成指定版本。默认生成 "),t("code",[s._v("lastest")]),s._v(" 的版本。")])])])}),[],!1,null,null,null);a.default=r.exports}}]);